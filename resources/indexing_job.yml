# Vector Index Job for unstructured_document_pipeline
# Note: Serverless notebook tasks install dependencies via %pip in the notebook itself
resources:
  jobs:
    vector_index_job:
      name: vector_index_job
      
      # Job configuration
      max_concurrent_runs: 1
      timeout_seconds: 3600
      
      tasks:
        - task_key: build_vector_index
          
          # Notebook task (serverless)
          # Dependencies are installed via %pip commands in the notebook
          notebook_task:
            notebook_path: ../src/indexing/build_vector_index.py
            source: WORKSPACE
            base_parameters:
              catalog_name: ${var.catalog_name}
              schema_name: ${var.schema_name}
              volume_name: ${var.volume_name}
              chunked_table_name: ctcbl_chunked_docs2
              embedding_model: gte-large-en-v1.5
              embedding_endpoint: ${var.vector_index_embedding_model}
              vector_index_name: ${var.vector_index_name}
              vector_search_endpoint: ${var.vector_search_endpoint}
              rag_utils_wheel: rag_utils-0.1.0-py3-none-any.whl
